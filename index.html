<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Игровой сайт</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        
        .header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            box-sizing: border-box;
            background-color: #2c3e50;
            color: white;
        }
        
        .profile-section {
            display: flex;
            align-items: center;
        }
        
        .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #3498db;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            overflow: hidden;
        }
        
        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .profile-btn {
            padding: 8px 15px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .main-buttons {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex-grow: 1;
            width: 100%;
            padding: 20px;
            box-sizing: border-box;
        }
        
        .top-buttons {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .game-btn {
            padding: 15px 40px;
            font-size: 20px;
            background-color: #2ecc71;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .action-btn {
            padding: 12px 25px;
            font-size: 16px;
            background-color: #e67e22;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="profile-section">
            <div class="avatar" id="user-avatar">
                <!-- Аватар будет загружен через JS -->
            </div>
            <button class="profile-btn" id="profile-btn">Мой профиль</button>
        </div>
    </div>
    
    <div class="main-buttons">
        <div class="top-buttons">
            <button class="action-btn" id="craft-btn">Крафт</button>
            <button class="action-btn" id="exchange-btn">Обменник</button>
        </div>
        <button class="game-btn" id="play-btn">Играть</button>
    </div>

    <script>
        // Инициализация Telegram WebApp
        const tg = window.Telegram.WebApp;
        
        // Проверяем, запущено ли в Telegram WebApp
        if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
            const user = tg.initDataUnsafe.user;
            
            // Сохраняем данные пользователя в cookie
            document.cookie = `tg_user_id=${user.id}; path=/; max-age=604800`; // 7 дней
            document.cookie = `tg_name=${encodeURIComponent(user.first_name || '')} ${encodeURIComponent(user.last_name || '')}; path=/; max-age=604800`;
            document.cookie = `tg_username=${user.username || ''}; path=/; max-age=604800`;
            
            // Устанавливаем аватар
            const avatar = document.getElementById('user-avatar');
            if (user.photo_url) {
                avatar.innerHTML = `<img src="${user.photo_url}" alt="Аватар">`;
            } else {
                // Если нет аватарки, показываем инициалы
                const initials = (user.first_name ? user.first_name[0] : '') + (user.last_name ? user.last_name[0] : '');
                avatar.textContent = initials || '?';
                avatar.style.fontSize = '20px';
                avatar.style.fontWeight = 'bold';
            }
            
            // Обработчики кнопок
            document.getElementById('profile-btn').addEventListener('click', () => {
                // Действие при нажатии на кнопку профиля
                alert(`Профиль пользователя: ${user.first_name || ''} ${user.last_name || ''}\n@${user.username || 'нет username'}`);
            });
            
            document.getElementById('craft-btn').addEventListener('click', () => {
                // Переход на страницу крафта
                alert('Переход на страницу крафта');
            });
            
            document.getElementById('exchange-btn').addEventListener('click', () => {
                // Переход на страницу обменника
                alert('Переход на страницу обменника');
            });
            
            document.getElementById('play-btn').addEventListener('click', () => {
                // Начало игры
                alert('Запуск игры!');
            });
        } else {
            // Если не в Telegram WebApp, показываем тестовые данные
            document.getElementById('user-avatar').textContent = 'T';
            document.cookie = `tg_user_id=12345; path=/; max-age=604800`;
            document.cookie = `tg_name=Тестовый Пользователь; path=/; max-age=604800`;
            document.cookie = `tg_username=test_user; path=/; max-age=604800`;
            
            alert('Приложение запущено вне Telegram. Используются тестовые данные.');
        }
    </script>
</body>
</html>
